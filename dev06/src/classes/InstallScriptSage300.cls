public with sharing class InstallScriptSage300
{
    public InstallScriptSage300(string IntegrationKey)
    {    	
       	list<Data_Page__c>dataPage = [select Id from Data_Page__c where Integration_Key__c=:IntegrationKey];       	
       	if(dataPage.size()>0)
       		return;
       	       
        loadPageData(IntegrationKey);
        loadPageDataSection(IntegrationKey);
        
        if (Test.isRunningTest())
        {
                //string strDataPageDtlforCustomer = '[{"Link_To__r.Name":null,"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"FOB Point","Field_API__c":"FOB","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Price List","Field_API__c":"PRICLIST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Via","Field_API__c":"SHPVIADESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Tax Group","Field_API__c":"CODETAXGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Inventory Location","Field_API__c":"LOCATION","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":"IDCUST","Field_Label__c":"Customer Number","Field_API__c":"IDCUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"On Hold","Field_API__c":"SWHOLD","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"2","Select_Field__c":"true","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Name","Field_API__c":"NAMECUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"National Account","Field_API__c":"IDNATACCT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Group Code","Field_API__c":"IDGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Terms Code","Field_API__c":"CODETERM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Credit Limit","Field_API__c":"AMTCRLIMT","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Billing Cycle","Field_API__c":"IDCYCL","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Account Set","Field_API__c":"IDACCTSET","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Payment Code","Field_API__c":"PAYMCODE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Link_To__r.Name":null,"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Interest Profile","Field_API__c":"CODESVCCHR","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"}]';
                string strDataPageDtlforCustomer = '[{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Date","Field_API__c":"SHIPDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Territory","Field_API__c":"TERRITORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":"INVNUMBER","Field_Label__c":"Invoice Number","Field_API__c":"INVNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":"Invoice_Detail","Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Bill Name","Field_API__c":"BILNAME","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"PO Number","Field_API__c":"PONUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Date","Field_API__c":"INVDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship To","Field_API__c":"SHIPTO","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer","Field_API__c":"CUSTOMER","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Lines","Field_API__c":"INVLINES","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Bill Name","Field_API__c":"BILNAME","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Location","Field_API__c":"LOCATION","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Via","Field_API__c":"SHIPVIA","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Date","Field_API__c":"INVDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Reference","Field_API__c":"REFERENCE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Billing Address","Field_API__c":"BILADDR1","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":"INVNUMBER","Field_Label__c":"Invoice Number","Field_API__c":"INVNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ext. Cost","Field_API__c":"EXTICOST","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Item","Field_API__c":"ITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Category","Field_API__c":"CATEGORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Unit Price","Field_API__c":"PRIUNTPRC","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Unit","Field_API__c":"INVUNIT","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Quantity Shipped","Field_API__c":"QTYSHIPPED","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Total","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Tax Total","Field_API__c":"INVETAXTOT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Total","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Total","Field_API__c":"INVNETWTX","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Serial Numbers","Field_API__c":"SERIALNO","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Category","Field_API__c":"CATEGORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Allow Item in Web Store","Field_API__c":"ALLOWONWEB","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Kitting Item","Field_API__c":"KITTING","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Default Price List Code","Field_API__c":"DEFPRICLST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"17","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Alternate Item Description","Field_API__c":"ALTITEMDSC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":"FMTITEMNO","Field_Label__c":"Item No.","Field_API__c":"FMTITEMNO","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Inactive","Field_API__c":"INACTIVE","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Sellable","Field_API__c":"SELLABLE","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Stock Item","Field_API__c":"STOCKITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Stocking Unit of Measure","Field_API__c":"STOCKUNIT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Account Set Code","Field_API__c":"CNTLACCT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Alternate Item Number","Field_API__c":"FMTALTITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"19","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Is Item a BOM Component","Field_API__c":"ISBOMCMPN","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Lot Numbers","Field_API__c":"LOTITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Default Picking Sequence","Field_API__c":"PICKINGSEQ","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"18","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Costing Method","Field_API__c":"COSTMETHOD","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Structure Code","Field_API__c":"ITEMBRKID","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"}]';
                loadPageDataDetail(strDataPageDtlforCustomer,IntegrationKey);
        }
        else
        {
            list<Data_Page_Detail__c> DataPageDtlLst = [select Id from Data_Page_Detail__c where Data_Page_Id__r.Integration_Key__c =:IntegrationKey  LIMIT 100];
            if(DataPageDtlLst.size() ==0)
            {                       
                string datapageDetail = '[{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Date","Field_API__c":"SHIPDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Territory","Field_API__c":"TERRITORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":"INVNUMBER","Field_Label__c":"Invoice Number","Field_API__c":"INVNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":"Invoice_Detail","Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Bill Name","Field_API__c":"BILNAME","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"PO Number","Field_API__c":"PONUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"AR Inquiry List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Date","Field_API__c":"INVDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship To","Field_API__c":"SHIPTO","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer","Field_API__c":"CUSTOMER","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Lines","Field_API__c":"INVLINES","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Bill Name","Field_API__c":"BILNAME","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Location","Field_API__c":"LOCDESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Via","Field_API__c":"SHPVIACODE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Date","Field_API__c":"INVDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Reference","Field_API__c":"REFERENCE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Billing Address","Field_API__c":"BILADDR1","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Information","Key_Value__c":null,"Key_Field__c":"INVNUMBER","Field_Label__c":"Invoice Number","Field_API__c":"INVNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ext. Cost","Field_API__c":"EXTICOST","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":"FMTITEMNO","Field_Label__c":"Item","Field_API__c":"ITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":"Product_Detail","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Category","Field_API__c":"CATEGORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Unit Price","Field_API__c":"PRIUNTPRC","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Unit","Field_API__c":"INVUNIT","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Quantity Shipped","Field_API__c":"QTYSHIPPED","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Total","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Total Tax","Field_API__c":"INVETAXTOT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoice Total","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Invoice Total","Field_API__c":"INVNETWTX","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Serial Numbers","Field_API__c":"SERIALNO","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Category","Field_API__c":"CATEGORY","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Allow Item in Web Store","Field_API__c":"ALLOWONWEB","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Kitting Item","Field_API__c":"KITTING","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Default Price List Code","Field_API__c":"DEFPRICLST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"17","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Alternate Item Description","Field_API__c":"ALTITEMDSC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":"FMTITEMNO","Field_Label__c":"Item No.","Field_API__c":"FMTITEMNO","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Inactive","Field_API__c":"INACTIVE","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Sellable","Field_API__c":"SELLABLE","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Stock Item","Field_API__c":"STOCKITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Stocking Unit of Measure","Field_API__c":"STOCKUNIT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Account Set Code","Field_API__c":"CNTLACCT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Alternate Item Number","Field_API__c":"FMTALTITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"19","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Is Item a BOM Component","Field_API__c":"ISBOMCMPN","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Lot Numbers","Field_API__c":"LOTITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Default Picking Sequence","Field_API__c":"PICKINGSEQ","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"18","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Costing Method","Field_API__c":"COSTMETHOD","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Structure Code","Field_API__c":"ITEMBRKID","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Product_Detail"}]';
                loadPageDataDetail(datapageDetail,IntegrationKey);
                               
                datapageDetail = '[{"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"FOB Point","Field_API__c":"FOB","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Inventory Location","Field_API__c":"LOCATION","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Tax Group","Field_API__c":"CODETAXGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Via","Field_API__c":"SHPVIADESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Price List","Field_API__c":"PRICLIST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":"IDCUST","Field_Label__c":"Customer Number","Field_API__c":"IDCUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Group Code","Field_API__c":"IDGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"National Account","Field_API__c":"IDNATACCT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"2","Select_Field__c":"true","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Name","Field_API__c":"NAMECUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"On Hold","Field_API__c":"SWHOLD","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Terms Code","Field_API__c":"CODETERM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Interest Profile","Field_API__c":"IDSVCCHRG","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Payment Code","Field_API__c":"PAYMCODE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Account Set","Field_API__c":"IDACCTSET","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Billing Cycle","Field_API__c":"IDBILLCYCL","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Credit Limit","Field_API__c":"AMTCRLIMT","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Type","Field_API__c":"TYPE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Date","Field_API__c":"ORDDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":"ORDNUMBER","Field_Label__c":"Order Number","Field_API__c":"ORDNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":"Sales_Order_Details","Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Expected Ship Date","Field_API__c":"EXPDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Reference","Field_API__c":"REFERENCE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Sales Order List","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"On Hold","Field_API__c":"ONHOLD","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"SalesOrder"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Qty Ship To Date","Field_API__c":"QTYSHPTODT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"6","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"UOM","Field_API__c":"PRICEUNIT","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Location","Field_API__c":"LOCATION","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Location Description","Field_API__c":"LOCDESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Unit Price","Field_API__c":"PRIUNTPRC","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":"FMTITEMNO","Field_Label__c":"Item","Field_API__c":"ITEM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":"Product_Detail","Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Qty Back Order","Field_API__c":"QTYBACKORD","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Qty Ordered","Field_API__c":"QTYORDERED","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Detail Line Item","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Qty Shipped","Field_API__c":"QTYSHIPPED","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer No.","Field_API__c":"CUSTOMER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship-Via Code Description","Field_API__c":"VIADESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Number","Field_API__c":"ORDNUMBER","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"17","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Discount Amount","Field_API__c":"INVDISCAMT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Excl. Tax Total","Field_API__c":"ORDTOTAL","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Total Tax Amount","Field_API__c":"INVTAXTOT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Subtotal Amount","Field_API__c":"INVSUBTOT","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Reference","Field_API__c":"REFERENCE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Terms Code","Field_API__c":"TERMS","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Date","Field_API__c":"ORDDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"2","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"On Hold","Field_API__c":"ONHOLD","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship-Via Code","Field_API__c":"SHIPVIA","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"18","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Last Posting Date","Field_API__c":"LASTPOST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Incl. Tax Total","Field_API__c":"INVNETWTX","ERP_System__c":"Sage300ERP","Data_Type__c":"Decimal","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"4","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Order Description","Field_API__c":"DESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Order Information","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Expected Ship Date","Field_API__c":"EXPDATE","ERP_System__c":"Sage300ERP","Data_Type__c":"Date","Link_To__r.Name":null,"Data_Page_Id__r.Name":"Sales_Order_Details"}]';
                loadPageDataDetail(datapageDetail,IntegrationKey);
                                
            }
        }
        
        loadLicenceData();
        
    }
    
   public void loadPageData(string IntegrationKey)
   {
   		string strDataPage='';
		//old data                        
    	//strDataPage='[{"Type__c":"List","Sort_Order__c":"21","Name__c":"AR Inquiry","Filter_Field__c":"CUSTOMER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeInvoices","Description__c":"View the list of AR Inquiries of this customer","Default__c":"false","Create_Tab__c":"true","Name":"ARInquiry"},{"Type__c":"Detail","Sort_Order__c":"24","Name__c":null,"Filter_Field__c":"FMTITEMNO","ERP_System__c":"Sage300ERP","ERP_Function__c":"icItemsFinder","Description__c":"Product Information","Default__c":"false","Create_Tab__c":"false","Name":"Product_Detail"},{"Type__c":"Detail","Sort_Order__c":"22","Name__c":null,"Filter_Field__c":"INVNUMBER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeInvoices","Description__c":null,"Default__c":"false","Create_Tab__c":"false","Name":"Invoice_Detail"},{"Type__c":"Detail","Sort_Order__c":"23","Name__c":null,"Filter_Field__c":"ORDNUMBER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeOrders","Description__c":null,"Default__c":"false","Create_Tab__c":"false","Name":"Sales_Order_Details"},{"Type__c":"Detail","Sort_Order__c":"19","Name__c":"Customer","Filter_Field__c":"IDCUST","ERP_System__c":"Sage300ERP","ERP_Function__c":"arCustomersFinder","Description__c":"View ERP Customer Information","Default__c":"true","Create_Tab__c":"true","Name":"Customer"},{"Type__c":"List","Sort_Order__c":"20","Name__c":"Sales Order","Filter_Field__c":"CUSTOMER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeOrders","Description__c":"View the list of Sales Order(s) of this customer","Default__c":"false","Create_Tab__c":"true","Name":"SalesOrder"},{"Type__c":"List","Sort_Order__c":"25","Name__c":"CustomerList","Filter_Field__c":null,"ERP_System__c":"Sage300ERP","ERP_Function__c":"arCustomersFinder","Description__c":"CustomerList","Default__c":"false","Create_Tab__c":"false","Name":"CustomerList"}]';
    	strDataPage='[{"Type__c":"Detail","Sort_Order__c":"19","Name__c":"Customer","Filter_Field__c":"IDCUST","ERP_System__c":"Sage300ERP","ERP_Function__c":"arCustomersFinder","Description__c":"View ERP Customer Information","Default__c":"true","Create_Tab__c":"true","Name":"Customer"},{"Type__c":"List","Sort_Order__c":"21","Name__c":"AR Inquiry","Filter_Field__c":"CUSTOMER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeInvoices","Description__c":"View the list of AR Inquiries of this customer","Default__c":"false","Create_Tab__c":"true","Name":"ARInquiry"},{"Type__c":"Detail","Sort_Order__c":"24","Name__c":null,"Filter_Field__c":"FMTITEMNO","ERP_System__c":"Sage300ERP","ERP_Function__c":"icItemsFinder","Description__c":"Product Information","Default__c":"false","Create_Tab__c":"false","Name":"Product_Detail"},{"Type__c":"Detail","Sort_Order__c":"22","Name__c":null,"Filter_Field__c":"INVNUMBER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeInvoices","Description__c":null,"Default__c":"false","Create_Tab__c":"false","Name":"Invoice_Detail"},{"Type__c":"Detail","Sort_Order__c":"23","Name__c":null,"Filter_Field__c":"ORDNUMBER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeOrders","Description__c":null,"Default__c":"false","Create_Tab__c":"false","Name":"Sales_Order_Details"},{"Type__c":"List","Sort_Order__c":"20","Name__c":"Sales Order","Filter_Field__c":"CUSTOMER","ERP_System__c":"Sage300ERP","ERP_Function__c":"oeOrders","Description__c":"View the list of Sales Order(s) of this customer","Default__c":"false","Create_Tab__c":"true","Name":"SalesOrder"},{"Type__c":"List","Sort_Order__c":"25","Name__c":"CustomerList","Filter_Field__c":null,"ERP_System__c":"Sage300ERP","ERP_Function__c":"arCustomersFinder","Description__c":"CustomerList","Default__c":"false","Create_Tab__c":"false","Name":"CustomerList"}]';
        
        List<map<String,String>> RecordList=(List<map<String,String>>)JSON.deserializeStrict(strDataPage,List<map<String,String>>.class);
        
        list<AggregateResult> datapageCount = [select Max(GUMU_Lite__Sort_Order__c) sortorder from GUMU_Lite__Data_Page__c ];
        string sortorder = string.valueOf(datapageCount[0].get('sortorder'));
		        
        list<Data_Page__c> lstDataPage = new list<Data_Page__c>();
        Data_Page__c DataPage;
        integer cnt =1;
        for(map<String,String> Record :RecordList)
        {           
            DataPage = new Data_Page__c();
            DataPage.put('Integration_Key__c',IntegrationKey); 
            for(string key :Record.keyset())
            {                   	           
                if(key =='Create_Tab__c')
                { 
                    DataPage.put(key,boolean.valueof(Record.get(key)));
                    DataPage.put('Create_Data_Page__c',boolean.valueof(Record.get(key)));
                }
                else if(key =='Default__c') 
                {
                    DataPage.put(key,boolean.valueof(Record.get(key)));
                    DataPage.put('Default_Data_Page__c',boolean.valueof(Record.get(key)));
                }
                else if(key =='Sort_Order__c')
                { 
                	system.debug('sortorder *** '+sortorder);
                	if(string.isBlank(sortorder))
                    	DataPage.put(key,integer.valueof(Record.get(key)));
                    else
                    {
                    	integer sortOrderNo = integer.valueOf(sortorder)+cnt;
                    	system.debug('sortOrderNo *** '+sortOrderNo);
                    	DataPage.put(key,sortOrderNo);
                    }
                    	
                } 
                else       
                    DataPage.put(key,Record.get(key));
            }   
            lstDataPage.add(DataPage);
            if(math.mod(cnt,10) ==0)
            {       
                insert lstDataPage;
                system.debug('lstEntityMap '+lstDataPage);
                lstDataPage = new list<Data_Page__c>();
            }
            cnt++;           
        }
        if(lstDataPage.size()>0)
        {
            insert lstDataPage;
        }
   }
   
   public void loadPageDataSection(string IntegrationKey)
   {    
   		string strDataPageSection='';		
    	//old data
        //string strDataPageSection='[{"Sort_Order__c":"3","Section_Name__c":"AR Inquiry List","Section_Detail_Type__c":"Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"AR Inquiry","Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"3","Section_Name__c":"Invoicing","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Sort_Order__c":"2","Section_Name__c":"Processing","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Sort_Order__c":"1","Section_Name__c":"Main","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"true","Data_Page_Id__r.Display_Name__c":"Customer","Data_Page_Id__r.Name":"Customer_Detail"},{"Sort_Order__c":"3","Section_Name__c":"Invoice Total","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Invoice Detail","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Section_Name__c":"Invoice Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Invoice Detail","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Section_Name__c":"Invoice Line Item","Section_Detail_Type__c":"Grid","Related_List_Name__c":"oeInvoiceDetails","ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Invoice Detail","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Section_Name__c":"Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"true","Data_Page_Id__r.Display_Name__c":"Product Detail","Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"1","Section_Name__c":"Sales Order List","Section_Detail_Type__c":"Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Sales Order","Data_Page_Id__r.Name":"Sales_Order"},{"Sort_Order__c":"1","Section_Name__c":"Order Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Sales Order Details","Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"2","Section_Name__c":"Detail Line Item","Section_Detail_Type__c":"Grid","Related_List_Name__c":"oeorderdetails","ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Display_Name__c":"Sales Order Details","Data_Page_Id__r.Name":"Sales_Order_Details"}]';
    	strDataPageSection='[{"Sort_Order__c":"3","Section_Name__c":"Invoice Total","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"2","Section_Name__c":"Detail Line Item","Section_Detail_Type__c":"Grid","Related_List_Name__c":"oeorderdetails","ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"1","Section_Name__c":"Order Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Sales_Order_Details"},{"Sort_Order__c":"1","Section_Name__c":"Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"true","Data_Page_Id__r.Name":"Product_Detail"},{"Sort_Order__c":"2","Section_Name__c":"Invoice Line Item","Section_Detail_Type__c":"Grid","Related_List_Name__c":"oeInvoiceDetails","ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Section_Name__c":"Invoice Information","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Invoice_Detail"},{"Sort_Order__c":"1","Section_Name__c":"AR Inquiry List","Section_Detail_Type__c":"Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"ARInquiry"},{"Sort_Order__c":"3","Section_Name__c":"Invoicing","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"2","Section_Name__c":"Processing","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"1","Section_Name__c":"Main","Section_Detail_Type__c":"Non-Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"true","Data_Page_Id__r.Name":"Customer"},{"Sort_Order__c":"1","Section_Name__c":"Sales Order List","Section_Detail_Type__c":"Grid","Related_List_Name__c":null,"ERP_System__c":"Sage300ERP","Default_Section__c":"false","Data_Page_Id__r.Name":"SalesOrder"}]';
        List<map<String,String>> RecordList=(List<map<String,String>>)JSON.deserializeStrict(strDataPageSection,List<map<String,String>>.class);
        
        list<Data_Page_Section__c> lstDataPageSection = new list<Data_Page_Section__c>();
        Data_Page_Section__c DataPageSection;
        integer cnt =1;
        string dataPageName='';
        string dataPageNameTemp='';
        string dataPageNameId='';
        for(map<String,String> Record :RecordList)
        {           
            DataPageSection = new Data_Page_Section__c();
            dataPageName=Record.get('Data_Page_Id__r.Name');
            //system.debug('dataPageName '+dataPageName);
            if(dataPageNameTemp ==  Record.get('Data_Page_Id__r.Name'))
            {
                DataPageSection.put('Data_Page_Id__c',dataPageNameId);
            }
            else
            {            
                Data_Page__c DatapageId =[select Id from Data_Page__c where Name =:dataPageName and Integration_Key__c=:IntegrationKey limit 1];
                dataPageNameId = string.valueOf(DatapageId.Id);
                DataPageSection.put('Data_Page_Id__c',dataPageNameId);
                
                dataPageNameTemp=dataPageName;
            }
            
            for(string key :Record.keyset())
            {    
                if(key != 'Data_Page_Id__r.Name' && key != 'Data_Page_Id__r.Display_Name__c') 
                {   
                    if(key == 'Default_Section__c')
                        DataPageSection.put(key,boolean.valueof(Record.get(key)));
                    else if(key == 'Sort_Order__c')
                        DataPageSection.put(key,integer.valueof(Record.get(key)));
                    else 
                        DataPageSection.put(key,Record.get(key));
                }   
            }
               
            lstDataPageSection.add(DataPageSection);
            if(math.mod(cnt,10) ==0)
            {       
                insert lstDataPageSection;
                system.debug('lstDataPageSection '+lstDataPageSection);
                lstDataPageSection = new list<Data_Page_Section__c>();
            }
            cnt++;        
        }
        if(lstDataPageSection.size()>0)
        {
            insert lstDataPageSection;
        }
   }
   
   
   public void loadPageDataDetail(string strDataPageDetail,string IntegrationKey)
   {    
        //string strDataPageDetail='[{"Sort_Order__c":"13","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Price List","Field_API__c":"PRICLIST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"17","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Ship Via","Field_API__c":"SHPVIADESC","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"16","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"FOB Point","Field_API__c":"FOB","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"15","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Tax Group","Field_API__c":"CODETAXGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"14","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Invoicing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Inventory Location","Field_API__c":"LOCATION","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"1","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Number","Field_API__c":"IDCUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"2","Select_Field__c":"true","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Customer Name","Field_API__c":"NAMECUST","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"3","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Group Code","Field_API__c":"IDGRP","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"5","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Main","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"On Hold","Field_API__c":"SWHOLD","ERP_System__c":"Sage300ERP","Data_Type__c":"Checkbox","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"7","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Account Set","Field_API__c":"IDACCTSET","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"8","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Terms Code","Field_API__c":"CODETERM","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"9","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Billing Cycle","Field_API__c":"IDCYCL","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"10","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Interest Profile","Field_API__c":"CODESVCCHR","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"11","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Payment Code","Field_API__c":"PAYMCODE","ERP_System__c":"Sage300ERP","Data_Type__c":"Text","Data_Page_Id__r.Display_Name__c":"Customer"},{"Sort_Order__c":"12","Select_Field__c":"false","Data_Page_Section_Id__r.Section_Name__c":"Processing","Key_Value__c":null,"Key_Field__c":null,"Field_Label__c":"Credit Limit","Field_API__c":"AMTCRLIMT","ERP_System__c":"Sage300ERP","Data_Type__c":"Number","Data_Page_Id__r.Display_Name__c":"Customer"}]';
        List<map<String,String>> RecordList=(List<map<String,String>>)JSON.deserializeStrict(strDataPageDetail,List<map<String,String>>.class);
        
        list<Data_Page_Detail__c> lstDataPageSection = new list<Data_Page_Detail__c>();
        Data_Page_Detail__c DataPageSection;
        integer cnt =1;
        string dataPageName='';
        string dataPageNameTemp='';
        string dataPageNameId='';
        
        string dataPageSecName='';
        string dataPageSecNameTemp='';
        string dataPageSecId='';

        
        string linkToPageId='';
        string LinkToPageName='';
        string LinkToPageNameTemp='';
        
        map<string,ID> DataPageList =new map<string,ID>();
        for (Data_Page__c dp:[select ID,Name from Data_Page__c LIMIT 200 ])
        {
            DataPageList.put(dp.Name,dp.ID);
        }
        
        
        for(map<String,String> Record :RecordList)
        {           
            //Code to fetch Datapage Id
            DataPageSection = new Data_Page_Detail__c();
            dataPageName=Record.get('Data_Page_Id__r.Name');
            
            system.debug('dataPageName '+dataPageName);
            
            if(dataPageNameTemp ==  Record.get('Data_Page_Id__r.Name'))
            {
                DataPageSection.put('Data_Page_Id__c',dataPageNameId);
            }
            else
            {            
                Data_Page__c DatapageId =[select Id from Data_Page__c where Name =:dataPageName and Integration_Key__c=:IntegrationKey limit 1];
                dataPageNameId = string.valueOf(DatapageId.Id);
                DataPageSection.put('Data_Page_Id__c',dataPageNameId);
                
                dataPageNameTemp=dataPageName;
            }
            
            
            // Code for linking to header datapage record
            LinkToPageName=Record.get('Link_To__r.Name');
            if(LinkToPageNameTemp ==  Record.get('Link_To__r.Name'))
            {
                DataPageSection.put('Link_To__c',linkToPageId);
            }
            else
            {            
                if (LinkToPageName !=null || LinkToPageName !='null')
                {                                  
                    if (DataPageList.get(LinkToPageName)!=null)
                    {
                        //Data_Page__c DatapageId =(DataPageList.get('LinkToPageName'));
                        linkToPageId = string.valueOf(DataPageList.get(LinkToPageName));
                        DataPageSection.put('Link_To__c',linkToPageId);
                        LinkToPageNameTemp=LinkToPageName;
                    }
                }                   
            }
            
            
            //Code to fetch datapage Section ID            
            //DataPageSection = new Data_Page_Detail__c();
            dataPageSecName=Record.get('Data_Page_Section_Id__r.Section_Name__c');
            system.debug('dataPageSecName '+dataPageSecName);
            if(dataPageSecNameTemp ==  Record.get('Data_Page_Section_Id__r.Section_Name__c'))
            {
                DataPageSection.put('Data_Page_Section_Id__c',dataPageSecId);
            }
            else
            {            
                Data_Page_Section__c DatapageSectionId =[select Id from Data_Page_Section__c where Section_Name__c=:dataPageSecName
                 and  Data_Page_Id__r.Name =:dataPageName and Data_Page_Id__r.Integration_Key__c =:IntegrationKey  limit 1];
                 
                dataPageSecId = string.valueOf(DatapageSectionId.Id);
                DataPageSection.put('Data_Page_Section_Id__c',dataPageSecId);
                
                dataPageSecNameTemp=dataPageSecName;
            }
            
            
            for(string key :Record.keyset())
            {   
                if(key != 'Data_Page_Section_Id__r.Section_Name__c' && key != 'Data_Page_Id__r.Name' && key != 'Data_Page_Id__r.Display_Name__c' && key != 'Link_To__r.Name') 
                {
                    if(key =='Sort_Order__c')
                        DataPageSection.put(key,integer.valueOf(Record.get(key)));
                    else if(key =='Select_Field__c')
                        DataPageSection.put(key,boolean.valueOf(Record.get(key)));  
                    else           
                        DataPageSection.put(key,Record.get(key));
                }
            }
               
            lstDataPageSection.add(DataPageSection);
            if(math.mod(cnt,10) ==0)
            {       
                insert lstDataPageSection;
                system.debug('lstDataPageSection '+lstDataPageSection);
                lstDataPageSection = new list<Data_Page_Detail__c>();
            }
            cnt++;        
        }
        if(lstDataPageSection.size()>0)
        {
            insert lstDataPageSection;
        }
   }
    
   public void loadLicenceData()
   {
        list<GUMU_App_Setting__c> GumuAppSettingLst = [select Id from GUMU_App_Setting__c LIMIT 100];
        if(GumuAppSettingLst.size() ==0)
        {
            string strAppSettingData='[{"No_of_Users__c":"10","Expiration_Date__c":"2016-07-01","ERP_System__c":"Sage300ERP","Activation_Key__c":"123456789","Name":"GUMU Sage 300 ERP"}]';
            List<map<String,String>> RecordList=(List<map<String,String>>)JSON.deserializeStrict(strAppSettingData,List<map<String,String>>.class);
            
            list<GUMU_App_Setting__c> lstAppSetting = new list<GUMU_App_Setting__c>();
            GUMU_App_Setting__c AppSetting;
            integer cnt =1;
            for(map<String,String> Record :RecordList)
            {           
                AppSetting = new GUMU_App_Setting__c();
                for(string key :Record.keyset())
                {                    
                   if(key=='Expiration_Date__c')
                        AppSetting.put(key,Date.valueOf(Record.get(key)));
                    else if(key=='No_of_Users__c')
                      AppSetting.put(key,integer.valueOf(Record.get(key)));
                     else                  
                        AppSetting.put(key,Record.get(key));
                }   
                lstAppSetting.add(AppSetting);
                if(math.mod(cnt,10) ==0)
                {       
                    insert lstAppSetting;
                    lstAppSetting = new list<GUMU_App_Setting__c>();
                }
                cnt++;
            
            }
            if(lstAppSetting.size()>0)
            {
                insert lstAppSetting;
            }
        }
   }  
   
}